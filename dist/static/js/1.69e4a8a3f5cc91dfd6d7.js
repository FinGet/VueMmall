webpackJsonp([1],{"9bBU":function(t,e,a){a("mClu");var s=a("FeBl").Object;t.exports=function(t,e,a){return s.defineProperty(t,e,a)}},C4MV:function(t,e,a){t.exports={default:a("9bBU"),__esModule:!0}},bOdI:function(t,e,a){"use strict";e.__esModule=!0;var s,i=a("C4MV"),o=(s=i)&&s.__esModule?s:{default:s};e.default=function(t,e,a){return e in t?(0,o.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},fzpE:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("bOdI"),i=a.n(s),o={name:"product",data:function(){return{pageNum:1,pageSize:10,total:0,lists:[],options:[{value:"productId",label:"按商品id查询"},{value:"productName",label:"按商品名称查询"}],selectvalue:"productId",input:"",dialogTitle:"",dialogVisible:!1,formLabelWidth:"100px",firstCategory:[],secondCategory:[],form:{name:"",subtitle:"",parentCategoryId:"",categoryId:"",price:"",stock:"",subImages:[],detail:"",id:""},type:"",editorOption:{modules:{toolbar:[["bold","italic","underline","strike"],[{font:[]}],[{header:1},{header:2}],["header","blockquote","code-block"],["image"]]}},rules:{name:[{required:!0,message:"请输入商品名称",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}],subtitle:[{required:!0,message:"请输入商品信息",trigger:"blur"}],parentCategoryId:[{required:!0,message:"请选择商品所属品类",trigger:"blur"}],price:[{type:"number",required:!0,message:"请输入商品价格",trigger:"blur"}],stock:[{type:"number",required:!0,message:"请输入商品库存",trigger:"blur"}],subImages:[{required:!0,message:"请上传商品图片",trigger:"blur"}],detail:[{required:!0,message:"请输入商品详情",trigger:"blur"}]},imgFile:{}}},computed:{disable:function(){return"detail"==this.type}},created:function(){this.getProductsLists(),this.getCategory()},methods:{getProductsLists:function(){var t=this,e={pageNum:this.pageNum,pageSize:this.pageSize};this.$http.get("/api/manage/product/list.do",{params:e}).then(function(e){var a=e.data;0==a.status&&(t.total=a.data.total,t.lists=a.data.list)})},getProductDetail:function(t){var e=this,a=this;this.$http.get("/api/manage/product/detail.do",{params:{productId:t}}).then(function(t){var s=t.data;if(0==s.status){var i=s.data.subImages&&s.data.subImages.split(",");for(var o in s.data.subImages=i&&i.map(function(t){return{uri:t,url:s.data.imageHost+t}}),a.form)!0===a.form.hasOwnProperty(o)&&(a.form[o]=s.data[o]);a.form.subImages=a.form.subImages||[],e.getCategory(e.form.parentCategoryId),console.log(e.form)}})},handleDetail:function(t,e){this.dialogVisible=!0,this.type="detail",this.getProductDetail(e.id)},handleEdit:function(t,e){this.dialogVisible=!0,this.type="edit",this.getProductDetail(e.id)},handleAdd:function(){this.type="add",this.dialogVisible=!0},onSetProductStatus:function(t,e){var a=this,s=1==e?"下架":"上架",i={productId:t,status:1==e?2:1};this.$confirm("确认"+s+"此商品?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$http.get("/api/manage/product/set_sale_status.do",{params:i}).then(function(t){var e=t.data;0==e.status?(a.getProductsLists(),a.$message({type:"success",message:e.data})):a.$message({type:"success",message:e.data})})}).catch(function(){a.$message({type:"info",message:"已取消"})})},search:function(){var t=this,e=i()({pageNum:1},this.selectvalue,this.input);this.$http.get("/api//manage/product/search.do",{params:e}).then(function(e){var a=e.data;0==a.status&&(t.total=a.data.total,t.lists=a.data.list)})},changPage:function(t){this.pageNum=t,this.getProductsLists()},closeDialog:function(){this.$refs.ruleForm.resetFields(),this.type="",this.secondCategory=[]},getCategory:function(t){var e=this;this.$http.get("/api/manage/category/get_category.do",{params:{categoryId:t||0}}).then(function(a){var s=a.data;0==s.status&&(t?e.secondCategory=s.data:e.firstCategory=s.data)})},chooseFirstCategory:function(t){this.form.categoryId="",this.secondCategory=[],this.getCategory(t)},submitForm:function(){var t=this;this.$refs.ruleForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;t.form.subImages=t.form.subImages.map(function(t){return t.uri}).join(","),t.$http.get("/api/manage/product/save.do",{params:t.form}).then(function(e){var a=e.data;0==a.status&&(t.$message.success(a.data),t.$refs.ruleForm.resetFields(),t.dialogVisible=!1,t.getProductsLists())})})},chooseImg:function(t){this.imgFile=t.target.value},uploadImg:function(){var t=this,e=new FormData(this.$refs.imgForm);console.log(this.imgFile),this.imgFile?this.$http.post("/api/manage/product/upload.do",e).then(function(e){var a=e.data;0==a.status&&t.form.subImages.push(a.data)}):this.$message.error("请选择图片上传!")},deleteImg:function(t){console.log(t),this.form.subImages.splice(t,1)}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"clearfix",attrs:{id:"product"}},[a("div",{staticClass:"page-top clearfix"},[a("div",{staticClass:"page-title left"},[t._v("商品管理")]),t._v(" "),a("el-button",{staticClass:"right",attrs:{type:"primary"},on:{click:t.handleAdd}},[a("i",{staticClass:"fa fa-plus"}),t._v("添加商品")])],1),t._v(" "),a("div",{staticClass:"search-box"},[a("el-row",[a("el-col",{attrs:{span:3}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.selectvalue,callback:function(e){t.selectvalue=e},expression:"selectvalue"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-col",{staticClass:"marginL10",attrs:{span:4}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}})],1),t._v(" "),a("el-col",{staticClass:"marginL10",attrs:{span:2}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.search}},[t._v("搜索")])],1)],1)],1),t._v(" "),a("div",{staticClass:"table-container"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.lists,border:"",stripe:""}},[a("el-table-column",{attrs:{label:"商品id",prop:"id",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{label:"商品名称",prop:"name"}}),t._v(" "),a("el-table-column",{attrs:{label:"商品信息",prop:"subtitle",width:"500"}}),t._v(" "),a("el-table-column",{attrs:{label:"商品价格",prop:"price"}}),t._v(" "),a("el-table-column",{attrs:{label:"状态",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"text"}},[t._v(t._s(1==e.row.status?"在售":"已下架"))]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(a){t.onSetProductStatus(e.row.id,e.row.status)}}},[t._v(t._s(1==e.row.status?"下架":"上架"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.handleDetail(e.$index,e.row)}}},[t._v("详情")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.handleEdit(e.$index,e.row)}}},[t._v("编辑")])]}}])})],1)],1),t._v(" "),t.total>t.pageSize?a("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"prev, pager, next","page-size":t.pageSize,total:t.total},on:{"current-change":t.changPage}}):t._e(),t._v(" "),a("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e},close:t.closeDialog}},[a("el-form",{ref:"ruleForm",attrs:{model:t.form,rules:t.rules,"label-width":t.formLabelWidth}},[a("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[a("el-input",{staticClass:"input300",attrs:{disabled:t.disable,autocomplete:"off"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"商品描述",prop:"subtitle"}},[a("el-input",{staticClass:"input300",attrs:{disabled:t.disable,autocomplete:"off"},model:{value:t.form.subtitle,callback:function(e){t.$set(t.form,"subtitle",e)},expression:"form.subtitle"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"所属品类",prop:"parentCategoryId"}},[a("el-select",{attrs:{disabled:t.disable,placeholder:"请选择一级分类"},on:{change:t.chooseFirstCategory},model:{value:t.form.parentCategoryId,callback:function(e){t.$set(t.form,"parentCategoryId",e)},expression:"form.parentCategoryId"}},t._l(t.firstCategory,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),t._v(" "),t.form.parentCategoryId?a("el-select",{attrs:{disabled:t.disable,placeholder:"请选择二级分类"},model:{value:t.form.categoryId,callback:function(e){t.$set(t.form,"categoryId",e)},expression:"form.categoryId"}},t._l(t.secondCategory,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})):t._e()],1),t._v(" "),a("el-form-item",{attrs:{label:"商品价格",prop:"price"}},[a("el-input",{staticClass:"input300",attrs:{disabled:t.disable,placeholder:"请输入内容"},model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",t._n(e))},expression:"form.price"}},[a("template",{slot:"append"},[t._v("元")])],2)],1),t._v(" "),a("el-form-item",{attrs:{label:"商品库存",prop:"stock"}},[a("el-input",{staticClass:"input300",attrs:{disabled:t.disable,placeholder:"请输入内容"},model:{value:t.form.stock,callback:function(e){t.$set(t.form,"stock",t._n(e))},expression:"form.stock"}},[a("template",{slot:"append"},[t._v("件")])],2)],1),t._v(" "),a("el-form-item",{attrs:{label:"商品图片",prop:"subImages"}},[t._l(t.form.subImages,function(e,s){return a("div",{key:e.uri,staticClass:"item-img"},[e.uri?a("img",{staticClass:"img",attrs:{width:"100px",src:e.url,alt:""}}):t._e(),t._v(" "),a("i",{staticClass:"el-icon-circle-close-outline",on:{click:function(e){t.deleteImg(s)}}})])}),t._v(" "),t.disable?t._e():a("form",{ref:"imgForm",attrs:{enctype:"multipart/form-data"}},[a("input",{attrs:{type:"file",name:"upload_file",value:"imgFile",accept:"image/png,image/gif,image/jpeg"},on:{change:function(e){t.chooseImg(e)}}}),t._v(" "),a("button",{attrs:{type:"submit"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.uploadImg(e)}}},[t._v("上传")])])],2),t._v(" "),a("el-form-item",{attrs:{label:"商品详情",prop:"detail"}},[t.disable?a("p",{staticClass:"detail",domProps:{innerHTML:t._s(t.form.detail)}}):a("quill-editor",{attrs:{options:t.editorOption},model:{value:t.form.detail,callback:function(e){t.$set(t.form,"detail",e)},expression:"form.detail"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),t.disable?t._e():a("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var l=a("VU/8")(o,r,!1,function(t){a("kpYo")},"data-v-6cd947a0",null);e.default=l.exports},kpYo:function(t,e){},mClu:function(t,e,a){var s=a("kM2E");s(s.S+s.F*!a("+E39"),"Object",{defineProperty:a("evD5").f})}});
//# sourceMappingURL=1.69e4a8a3f5cc91dfd6d7.js.map